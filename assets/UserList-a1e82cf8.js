import{b as l,d as c,I as X,k as L,i as x,a as T,e as o,A as b,y as w,J as O,_ as Y,p as A,s as B,q as F,r as y,o as U,m as W,L as V,M as q,N as R,g as _,f as u,F as M,w as S,j as H,O as P,t as E}from"./index-dcbbacec.js";import{u as j,E as Z}from"./loading-e715e2f3.js";import{E as J}from"./ElectroNoResult-c0acc833.js";const N=(t,s)=>{const e=t.__vccOpts||t;for(const[r,i]of s)e[r]=i;return e},K={name:"Slide",props:{index:{type:Number}},data(){return{parent:this.$parent,styles:{},zIndex:999}},computed:{isCurrent(){return this.index===this.parent.currentIndex},leftIndex(){return this.parent.oneDirectional&&this.getSideIndex(this.parent.leftIndices)>this.parent.currentIndex-1?-1:this.getSideIndex(this.parent.leftIndices)},rightIndex(){return this.parent.oneDirectional&&this.getSideIndex(this.parent.rightIndices)>this.parent.total-this.parent.currentIndex-2?-1:this.getSideIndex(this.parent.rightIndices)},slideStyle(){let t={};if(!this.isCurrent){const s=this.leftIndex,e=this.rightIndex;(e>=0||s>=0)&&(t=e>=0?this.calculatePosition(e,!0,this.zIndex):this.calculatePosition(s,!1,this.zIndex),t.opacity=1,t.visibility="visible"),this.parent.hasHiddenSlides&&(this.matchIndex(this.parent.leftOutIndex)?t=this.calculatePosition(this.parent.leftIndices.length-1,!1,this.zIndex):this.matchIndex(this.parent.rightOutIndex)&&(t=this.calculatePosition(this.parent.rightIndices.length-1,!0,this.zIndex)))}return Object.assign(t,{"border-width":this.parent.border+"px",width:this.parent.slideWidth+"px",height:this.parent.slideHeight+"px",transition:" transform "+this.parent.animationSpeed+"ms,                opacity "+this.parent.animationSpeed+"ms,                visibility "+this.parent.animationSpeed+"ms"})},computedClasses(){return{[`left-${this.leftIndex+1}`]:this.leftIndex>=0,[`right-${this.rightIndex+1}`]:this.rightIndex>=0,current:this.isCurrent}}},methods:{getSideIndex(t){let s=-1;return t.forEach((e,r)=>{this.matchIndex(e)&&(s=r)}),s},matchIndex(t){return t>=0?this.index===t:this.parent.total+t===this.index},calculatePosition(t,s,e){const r=this.parent.disable3d?0:parseInt(this.parent.inverseScaling)+(t+1)*100,i=this.parent.disable3d?0:parseInt(this.parent.perspective),n=this.parent.space==="auto"?parseInt((t+1)*(this.parent.width/1.5),10):parseInt((t+1)*this.parent.space,10),d=s?"translateX("+n+"px) translateZ(-"+r+"px) rotateY(-"+i+"deg)":"translateX(-"+n+"px) translateZ(-"+r+"px) rotateY("+i+"deg)",I=this.parent.space==="auto"?0:parseInt((t+1)*this.parent.space);return{transform:d,top:I,zIndex:e-(Math.abs(t)+1)}},goTo(){if(!this.isCurrent)this.parent.clickable===!0&&this.parent.goFar(this.index);else{const{index:t}=this;this.parent.onMainSlideClick({index:t})}}}};function G(t,s,e,r,i,n){return l(),c("div",{class:L(["carousel-3d-slide",n.computedClasses]),style:x(n.slideStyle),onClick:s[0]||(s[0]=d=>n.goTo())},[X(t.$slots,"default",{index:e.index,isCurrent:n.isCurrent,leftIndex:n.leftIndex,rightIndex:n.rightIndex})],6)}const D=N(K,[["render",G]]),Q={props:{autoplay:{type:Boolean,default:!1},autoplayTimeout:{type:Number,default:2e3},autoplayHoverPause:{type:Boolean,default:!0}},data(){return{autoplayInterval:null}},destroyed(){this.process_server||(this.pauseAutoplay(),this.$el.removeEventListener("mouseenter",this.pauseAutoplay),this.$el.removeEventListener("mouseleave",this.startAutoplay))},methods:{pauseAutoplay(){this.autoplayInterval&&(this.autoplayInterval=clearInterval(this.autoplayInterval))},startAutoplay(){this.autoplay&&(this.autoplayInterval=setInterval(()=>{this.dir==="ltr"?this.goPrev():this.goNext()},this.autoplayTimeout))}},mounted(){!this.process_server&&this.autoplayHoverPause&&(this.$el.addEventListener("mouseenter",this.pauseAutoplay),this.$el.addEventListener("mouseleave",this.startAutoplay),this.startAutoplay())}},tt={name:"Controls",props:{width:{type:[String,Number],default:50},height:{type:[String,Number],default:60},prevHtml:{type:String,default:"&lsaquo;"},nextHtml:{type:String,default:"&rsaquo;"}},data(){return{parent:this.$parent}}},et={class:"carousel-3d-controls"},st=["innerHTML"],it=["innerHTML"];function nt(t,s,e,r,i,n){return l(),c("div",et,[o("a",{href:"#",class:L(["prev",{disabled:!i.parent.isPrevPossible}]),onClick:s[0]||(s[0]=O(d=>i.parent.goPrev(),["prevent"])),style:x(`width: ${e.width}px; height: ${e.height}px; line-height: ${e.height}px;`),"aria-label":"Previous slide"},[o("span",{innerHTML:e.prevHtml},null,8,st)],6),o("a",{href:"#",class:L(["next",{disabled:!i.parent.isNextPossible}]),onClick:s[1]||(s[1]=O(d=>i.parent.goNext(),["prevent"])),style:x(`width: ${e.width}px; height: ${e.height}px; line-height: ${e.height}px;`),"aria-label":"Next slide"},[o("span",{innerHTML:e.nextHtml},null,8,it)],6)])}const rt=N(tt,[["render",nt],["__scopeId","data-v-475a7b20"]]),f=()=>{},at={name:"Carousel3d",components:{Controls:rt},props:{count:{type:[Number,String],default:0},perspective:{type:[Number,String],default:35},display:{type:[Number,String],default:5},loop:{type:Boolean,default:!0},animationSpeed:{type:[Number,String],default:500},dir:{type:String,default:"rtl"},width:{type:[Number,String],default:360},height:{type:[Number,String],default:270},border:{type:[Number,String],default:1},space:{type:[Number,String],default:"auto"},startIndex:{type:[Number,String],default:0},clickable:{type:Boolean,default:!0},disable3d:{type:Boolean,default:!1},minSwipeDistance:{type:Number,default:10},inverseScaling:{type:[Number,String],default:300},controlsVisible:{type:Boolean,default:!1},controlsPrevHtml:{type:String,default:"&lsaquo;"},controlsNextHtml:{type:String,default:"&rsaquo;"},controlsWidth:{type:[String,Number],default:50},controlsHeight:{type:[String,Number],default:50},onLastSlide:{type:Function,default:f},onSlideChange:{type:Function,default:f},bias:{type:String,default:"left"},onMainSlideClick:{type:Function,default:f},oneDirectional:{type:Boolean,default:!1}},data(){return{viewport:0,currentIndex:0,total:0,dragOffsetX:0,dragStartX:0,dragOffsetY:0,dragStartY:0,mousedown:!1,zIndex:998,process_server:typeof window===void 0}},mixins:[Q],watch:{count(){this.computeData()}},computed:{isLastSlide(){return this.currentIndex===this.total-1},isFirstSlide(){return this.currentIndex===0},isNextPossible(){return!(!this.loop&&this.isLastSlide)},isPrevPossible(){return!(!this.loop&&this.isFirstSlide)},slideWidth(){const t=this.viewport,s=parseInt(this.width)+parseInt(this.border,10)*2;return t<s&&!this.process_server?t:s},slideHeight(){const t=parseInt(this.width,10)+parseInt(this.border,10)*2,s=parseInt(parseInt(this.height)+this.border*2,10),e=this.calculateAspectRatio(t,s);return this.slideWidth/e},visible(){return this.display>this.total?this.total:this.display},hasHiddenSlides(){return this.total>this.visible},leftIndices(){let t=(this.visible-1)/2;t=this.bias.toLowerCase()==="left"?Math.ceil(t):Math.floor(t);const s=[];for(let e=1;e<=t;e++)s.push(this.dir==="ltr"?(this.currentIndex+e)%this.total:(this.currentIndex-e)%this.total);return s},rightIndices(){let t=(this.visible-1)/2;t=this.bias.toLowerCase()==="right"?Math.ceil(t):Math.floor(t);const s=[];for(let e=1;e<=t;e++)s.push(this.dir==="ltr"?(this.currentIndex-e)%this.total:(this.currentIndex+e)%this.total);return s},leftOutIndex(){let t=(this.visible-1)/2;return t=this.bias.toLowerCase()==="left"?Math.ceil(t):Math.floor(t),t++,this.dir==="ltr"?this.total-this.currentIndex-t<=0?-parseInt(this.total-this.currentIndex-t):this.currentIndex+t:this.currentIndex-t},rightOutIndex(){let t=(this.visible-1)/2;return t=this.bias.toLowerCase()==="right"?Math.ceil(t):Math.floor(t),t++,this.dir==="ltr"?this.currentIndex-t:this.total-this.currentIndex-t<=0?-parseInt(this.total-this.currentIndex-t,10):this.currentIndex+t}},methods:{goNext(){this.isNextPossible&&(this.isLastSlide?this.goSlide(0):this.goSlide(this.currentIndex+1))},goPrev(){this.isPrevPossible&&(this.isFirstSlide?this.goSlide(this.total-1):this.goSlide(this.currentIndex-1))},goSlide(t){this.currentIndex=t<0||t>this.total-1?0:t,this.isLastSlide&&(this.onLastSlide!==f&&console.warn("onLastSlide deprecated, please use @last-slide"),this.onLastSlide(this.currentIndex),this.$emit("last-slide",this.currentIndex)),this.$emit("before-slide-change",this.currentIndex),setTimeout(()=>this.animationEnd(),this.animationSpeed)},goFar(t){let s=t===this.total-1&&this.isFirstSlide?-1:t-this.currentIndex;this.isLastSlide&&t===0&&(s=1);const e=s<0?-s:s;let r=0,i=0;for(;i<e;)i+=1,setTimeout(()=>s<0?this.goPrev(e):this.goNext(e),e===1?0:r),r+=this.animationSpeed/e},animationEnd(){this.onSlideChange!==f&&console.warn("onSlideChange deprecated, please use @after-slide-change"),this.onSlideChange(this.currentIndex),this.$emit("after-slide-change",this.currentIndex)},handleMouseup(){this.mousedown=!1,this.dragOffsetX=0,this.dragOffsetY=0},handleMousedown(t){t.touches||t.preventDefault(),this.mousedown=!0,this.dragStartX="ontouchstart"in window?t.touches[0].clientX:t.clientX,this.dragStartY="ontouchstart"in window?t.touches[0].clientY:t.clientY},handleMousemove(t){if(!this.mousedown)return;const s="ontouchstart"in window?t.touches[0].clientX:t.clientX,e="ontouchstart"in window?t.touches[0].clientY:t.clientY,r=this.dragStartX-s,i=this.dragStartY-e;this.dragOffsetX=r,this.dragOffsetY=i,!(Math.abs(this.dragOffsetY)>Math.abs(this.dragOffsetX))&&(this.dragOffsetX>this.minSwipeDistance?(this.handleMouseup(),this.goNext()):this.dragOffsetX<-this.minSwipeDistance&&(this.handleMouseup(),this.goPrev()))},attachMutationObserver(){const t=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(t){const s={attributes:!0,childList:!0,characterData:!0};this.mutationObserver=new t(()=>{this.$nextTick(()=>{this.computeData()})}),this.$el&&this.mutationObserver.observe(this.$el,s)}},detachMutationObserver(){this.mutationObserver&&this.mutationObserver.disconnect()},getSlideCount(){const t=this.$slots.default();return t.length>0?t[0].children.length:0},calculateAspectRatio(t,s){return Math.min(t/s)},computeData(t){this.total=this.getSlideCount(),(t||this.currentIndex>=this.total)&&(this.currentIndex=parseInt(this.startIndex)>this.total-1?this.total-1:parseInt(this.startIndex)),this.viewport=this.$el.clientWidth},setSize(){this.$el.style.cssText+="height:"+this.slideHeight+"px;",this.$el.childNodes[0].style.cssText+="width:"+this.slideWidth+"px; height:"+this.slideHeight+"px;"}},mounted(){this.process_server||(this.computeData(!0),this.attachMutationObserver(),window.addEventListener("resize",this.setSize),"ontouchstart"in window?(this.$el.addEventListener("touchstart",this.handleMousedown),this.$el.addEventListener("touchend",this.handleMouseup),this.$el.addEventListener("touchmove",this.handleMousemove)):(this.$el.addEventListener("mousedown",this.handleMousedown),this.$el.addEventListener("mouseup",this.handleMouseup),this.$el.addEventListener("mousemove",this.handleMousemove)))},beforeDestroy(){this.process_server||(this.detachMutationObserver(),"ontouchstart"in window?this.$el.removeEventListener("touchmove",this.handleMousemove):this.$el.removeEventListener("mousemove",this.handleMousemove),window.removeEventListener("resize",this.setSize))}};function lt(t,s,e,r,i,n){const d=T("controls");return l(),c("div",{class:"carousel-3d-container",style:x({height:this.slideHeight+"px"})},[o("div",{class:"carousel-3d-slider",style:x({width:this.slideWidth+"px",height:this.slideHeight+"px"})},[X(t.$slots,"default",{},void 0,!0)],4),e.controlsVisible?(l(),b(d,{key:0,"next-html":e.controlsNextHtml,"prev-html":e.controlsPrevHtml,width:e.controlsWidth,height:e.controlsHeight},null,8,["next-html","prev-html","width","height"])):w("",!0)],4)}const z=N(at,[["render",lt],["__scopeId","data-v-d1f6685d"]]);const ot={class:"userlist"},ht={key:0,class:"user-create"},dt={alt:"image"},ut={class:"desc"},ct={key:1,class:"user-star"},pt={alt:"image"},gt={class:"desc"},vt={__name:"UserList",setup(t){const s=A(),{uid:e}=B(s),r=F(),i=y([]),n=y([]),d=y(null),I=y(null),{isLoading:p,hideLoad:$}=j();U(()=>{e.value?(p.value=!0,C()):$()}),W(e,g=>{g?(p.value=!0,C()):(i.value=[],n.value=[])});const C=async()=>{(await V(e.value)).playlist.forEach(h=>{h.coverImgUrl=q(h.coverImgUrl),h.creator.userId===Number(e.value)?i.value.push(h):n.value.push(h)}),$()},k=g=>{let a,h;g===0?(a=d.value.currentIndex,h=i.value[a].id):(a=I.value.currentIndex,h=n.value[a].id),r.push(`/music/details/${h}`)};return(g,a)=>{const h=R("img-lazy");return l(),c("div",ot,[_(Z,{show:u(p)},null,8,["show"]),!u(p)&&u(e)?(l(),c(M,{key:0},[i.value.length>0?(l(),c("div",ht,[a[1]||(a[1]=o("div",{class:"userlist-title"},"我创建的歌单",-1)),_(u(z),{ref_key:"carousel",ref:d,count:i.value.length,width:120,height:120,display:5,controlsVisible:"true",space:100,clickable:!0,onMainSlideClick:()=>k(0)},{default:S(()=>[(l(!0),c(M,null,H(i.value,(v,m)=>(l(),b(u(D),{key:m,index:m},{default:S(()=>[P(o("img",dt,null,512),[[h,v.coverImgUrl]]),o("p",ut,"《"+E(v.name)+"》",1),a[0]||(a[0]=o("div",{class:"mask"},null,-1))]),_:2},1032,["index"]))),128))]),_:1},8,["count","onMainSlideClick"])])):w("",!0),n.value.length>0?(l(),c("div",ct,[a[3]||(a[3]=o("div",{class:"userlist-title"},"我收藏的歌单",-1)),_(u(z),{ref_key:"carouselStar",ref:I,count:n.value.length,width:120,height:120,display:5,controlsVisible:"true",space:100,clickable:!0,onMainSlideClick:()=>k(1)},{default:S(()=>[(l(!0),c(M,null,H(n.value,(v,m)=>(l(),b(u(D),{key:m,index:m},{default:S(()=>[P(o("img",pt,null,512),[[h,v.coverImgUrl]]),o("p",gt,"《"+E(v.name)+"》",1),a[2]||(a[2]=o("div",{class:"mask"},null,-1))]),_:2},1032,["index"]))),128))]),_:1},8,["count","onMainSlideClick"])])):w("",!0)],64)):!u(p)&&!u(e)?(l(),b(J,{key:1,title:"空空如也，快去登录看看吧~"})):w("",!0)])}}},It=Y(vt,[["__scopeId","data-v-55b28021"]]);export{It as default};
